{% extends "base.html" %}
{% load static %}

{% block category %}
<div class="collapse navbar-collapse">
	<ul class="navbar-nav mr-auto">
		<li class="nav-item">
			<a class="nav-link" href="{% url 'index' %}">Home</a>
		</li>
		<li class="nav-item dropdown">
			<a class="nav-link dropdown-toggle" href="#">Categories</a>
			<ul class="dropdown-menu">
				{% for cat in category %}
				<li><a class="dropdown-item" href="{% url 'category' cat.slug %}">{{cat.name}}</a></li>
				{% endfor %}
			</ul>
		</li>
	</ul>
</div>
{% endblock category %}

{% block body %}
<!-- section main content -->
<section class="main-content mt-3">
	<div class="container-xl">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
				<li class="breadcrumb-item"><a href="{% url 'category' post.category.slug %}">{{post.category.name}}</a></li>
				<li class="breadcrumb-item active" aria-current="page">{{post.title}}</li>
			</ol>
		</nav>

		<div class="row gy-4">
			<div class="col-lg-8">
				<!-- post single -->
				<div class="post post-single">
					<!-- post header -->
					<div class="post-header">
						<h1 class="title mt-0 mb-3">{{post.title}}</h1>
						<ul class="meta list-inline mb-0">
							<li class="list-inline-item"><a href="#">{{post.author}}</a></li>
							<li class="list-inline-item"><a href="{% url 'category' post.category.slug %}">{{post.category.name}}</a></li>
							<li class="list-inline-item">{{post.date|date:"F d, Y"}}</li>
						</ul>
					</div>
					
					<!-- featured image -->
					<div class="featured-image">
						<img src="{{post.img.url}}" alt="{{post.title}}" />
					</div>
					
					<!-- post content -->
					<div class="post-content clearfix">
						<p>{{post.content}}</p>
					</div>
					
					<!-- post bottom section -->
					<div class="post-bottom">
						<div class="row d-flex align-items-center">
							<div class="col-md-6 col-12 text-center text-md-start">
								<!-- tags -->
								<a href="#" class="tag">#{{post.section}}</a>
								<a href="{% url 'category' post.category.slug %}" class="tag">#{{post.category.name}}</a>
							</div>
							<div class="col-md-6 col-12">
								<!-- social icons -->
								<ul class="social-icons list-unstyled list-inline mb-0 float-md-end">
									<li class="list-inline-item"><a href="#"><i class="fab fa-facebook-f"></i></a></li>
									<li class="list-inline-item"><a href="#"><i class="fab fa-twitter"></i></a></li>
									<li class="list-inline-item"><a href="#"><i class="fab fa-linkedin-in"></i></a></li>
									<li class="list-inline-item"><a href="#"><i class="fab fa-pinterest"></i></a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>

				<div class="spacer" data-height="50"></div>

				<!-- author info -->
				<div class="about-author padding-30 rounded">
					<div class="thumb">
						<img src="{% static 'images/other/DP.png' %}" alt="{{post.author}}" />
					</div>
					<div class="details">
						<h4 class="name"><a href="#">{{post.author}}</a></h4>
						<p>Computer Science Student and AI Engineer Aspirant</p>
						<ul class="social-icons list-unstyled list-inline mb-0">
						<li class="list-inline-item"><a href="https://www.facebook.com/ashraful.islam.924584"><i class="fab fa-facebook-f"></i></a></li>
						<li class="list-inline-item"><a href="https://www.linkedin.com/in/ashraful-islam-a31268226/"><i class="fab fa-linkedin"></i></a></li>
						{% comment %} <li class="list-inline-item"><a href="#"><i class="fab fa-instagram"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fab fa-pinterest"></i></a></li> {% endcomment %}
						<li class="list-inline-item"><a href="https://medium.com/@ashrafdcc1502"><i class="fab fa-medium"></i></a></li>
						{% comment %} <li class="list-inline-item"><a href="#"><i class="fab fa-youtube"></i></a></li> {% endcomment %}
					</ul>
						
					</div>
				</div>

				<div class="spacer" data-height="50"></div>

				<!-- section header -->
				<div class="section-header">
					<h3 class="section-title">Comments ({{comments.count}})</h3>
					<img src="{% static 'images/wave.svg' %}" class="wave" alt="wave" />
				</div>
				
				<!-- post comments -->
				<div class="comments bordered padding-30 rounded">
					<ul class="comments">
						{% for comment in comments %}
						<!-- comment item -->
						<li class="comment rounded">
							<div class="thumb">
								<img src="{% static 'images/other/comment-1.png' %}" alt="{{comment.name}}" />
							</div>
							<div class="details">
								<h4 class="name"><a href="#">{{comment.name}}</a></h4>
								<span class="date">{{comment.date|date:"F d, Y - h:i A"}}</span>
								<p>{{comment.comment}}</p>
								<a href="#comment-form" class="btn btn-default btn-sm reply-btn" data-comment-id="{{comment.id}}" data-comment-name="{{comment.name}}">Reply</a>
								
								<!-- Display replies -->
								{% if comment.replies.all %}
								<ul class="comments replied">
									{% for reply in comment.replies.all %}
									<li class="comment rounded">
										<div class="thumb">
											<img src="{% static 'images/other/comment-1.png' %}" alt="{{reply.name}}" />
										</div>
										<div class="details">
											<h4 class="name"><a href="#">{{reply.name}}</a></h4>
											<span class="date">{{reply.date|date:"F d, Y - h:i A"}}</span>
											<p>{{reply.comment}}</p>
										</div>
									</li>
									{% endfor %}
								</ul>
								{% endif %}
							</div>
						</li>
						{% empty %}
						<p class="text-center">No comments yet. Be the first to comment!</p>
						{% endfor %}
					</ul>
				</div>

				<div class="spacer" data-height="50"></div>

				<!-- section header -->
				<div class="section-header">
					<h3 class="section-title">Leave Comment</h3>
					<img src="{% static 'images/wave.svg' %}" class="wave" alt="wave" />
				</div>
				
				<!-- comment form -->
				<div class="comment-form rounded bordered padding-30" id="comment-form">
					<div id="reply-info" style="display:none; margin-bottom:15px; padding:10px; background:#f8f9fa; border-radius:5px;">
						Replying to <strong id="reply-name"></strong>
						<button type="button" onclick="cancelReply()" style="float:right; border:none; background:transparent; cursor:pointer;">âœ•</button>
					</div>
					
					<form method="post" action="{% url 'add_comment' post.blog_slug %}">
						<div class="messages"></div>
						{% csrf_token %}
						
						<!-- Hidden field for parent comment -->
						<input type="hidden" name="parent_id" id="parent_id" value="">
						
						<div class="row">
							<div class="column col-md-12">
								<div class="form-group">
									<textarea name="InputComment" id="InputComment" class="form-control" rows="4" placeholder="Your comment here..." required></textarea>
								</div>
							</div>
							
							<div class="column col-md-6">
								<div class="form-group">
									<input type="email" class="form-control" id="InputEmail" name="InputEmail" placeholder="Email address" required>
								</div>
							</div>
							
							<div class="column col-md-6">
								<div class="form-group">
									<input type="url" class="form-control" name="InputWeb" id="InputWeb" placeholder="Website (optional)">
								</div>
							</div>
							
							<div class="column col-md-12">
								<div class="form-group">
									<input type="text" class="form-control" id="InputName" name="InputName" placeholder="Your name" required>
								</div>
							</div>
						</div>
						
						<button type="submit" class="btn btn-default">Submit Comment</button>
					</form>
				</div>
			</div>

			<div class="col-lg-4">
				<!-- sidebar -->
				<div class="sidebar">
					<!-- widget about -->
					<div class="widget rounded">
						<div class="widget-about data-bg-image text-center" data-bg-image="{% static 'images/map-bg.png' %}">
							<img src="{% static 'images/logo_as.png' %}" alt="logo" width='220px' height='auto' class="mb-4" />
							<p class="mb-4">Hello, Enhance your Knowledge by reading Blog</p>
							<ul class="social-icons list-unstyled list-inline mb-0">
						<li class="list-inline-item"><a href="https://www.facebook.com/ashraful.islam.924584"><i class="fab fa-facebook-f"></i></a></li>
						<li class="list-inline-item"><a href="https://www.linkedin.com/in/ashraful-islam-a31268226/"><i class="fab fa-linkedin"></i></a></li>
						{% comment %} <li class="list-inline-item"><a href="#"><i class="fab fa-instagram"></i></a></li>
						<li class="list-inline-item"><a href="#"><i class="fab fa-pinterest"></i></a></li> {% endcomment %}
						<li class="list-inline-item"><a href="https://medium.com/@ashrafdcc1502"><i class="fab fa-medium"></i></a></li>
						{% comment %} <li class="list-inline-item"><a href="#"><i class="fab fa-youtube"></i></a></li> {% endcomment %}
					</ul>
						</div>
					</div>

					<!-- widget recent posts -->
					<div class="widget rounded">
						<div class="widget-header text-center">
							<h3 class="widget-title">Recent Posts</h3>
							<img src="{% static 'images/wave.svg' %}" class="wave" alt="wave" />
						</div>
						<div class="widget-content">
							{% for blog in posts %}
							<div class="post post-list-sm circle">
								<div class="thumb circle">
									<span class="number">{{forloop.counter}}</span>
									<a href="{% url 'blog_detail' blog.blog_slug %}">
										<div class="inner">
											<img src="{{blog.img.url}}" alt="{{blog.title}}" />
										</div>
									</a>
								</div>
								<div class="details clearfix">
									<h6 class="post-title my-0"><a href="{% url 'blog_detail' blog.blog_slug %}">{{blog.title}}</a></h6>
									<ul class="meta list-inline mt-1 mb-0">
										<li class="list-inline-item">{{blog.date|date:"F d, Y"}}</li>
									</ul>
								</div>
							</div>
							{% endfor %}
						</div>
					</div>

					<!-- widget categories -->
					<div class="widget rounded">
						<div class="widget-header text-center">
							<h3 class="widget-title">Explore Topics</h3>
							<img src="{% static 'images/wave.svg' %}" class="wave" alt="wave" />
						</div>
						<div class="widget-content">
							<ul class="list">
								{% for cat in category %}
								<li><a href="{% url 'category' cat.slug %}">{{cat.name}}</a><span>({{cat.blogs.count}})</span></li>
								{% endfor %}
							</ul>
						</div>
					</div>

					<!-- widget tags -->
					<div class="widget rounded">
						<div class="widget-header text-center">
							<h3 class="widget-title">Tag Clouds</h3>
							<img src="{% static 'images/wave.svg' %}" class="wave" alt="wave" />
						</div>
						<div class="widget-content">
							<a href="#" class="tag">#Trending</a>
							<a href="#" class="tag">#Featured</a>
							<a href="#" class="tag">#{{post.section}}</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<!-- instagram feed -->
<div class="instagram">
	<div class="container-xl">
		<a href="https://www.instagram.com/ashraf_1600_/" class="btn btn-default btn-instagram">Ashraf on Instagram</a>
		<div class="instagram-feed d-flex flex-wrap">
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="https://www.instagram.com/p/DFhefLLpHX2/?img_index=1"><img src="{% static 'images/insta/insta_ash1.png' %}" alt="insta" /></a>
			</div>
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="https://www.instagram.com/p/C8U2xbxyUqs/?img_index=1"><img src="{% static 'images/insta/insta_ash2.png' %}" alt="insta" /></a>
			</div>
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="https://www.instagram.com/p/DBQr7UfJWxu/"><img src="{% static 'images/insta/insta_ash3.png' %}" alt="insta" /></a>
			</div>
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="#"><img src="{% static 'images/insta/insta_ash4.png' %}" alt="insta" /></a>
			</div>
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="#"><img src="{% static 'images/insta/insta_ash5.png' %}" alt="insta" /></a>
			</div>
			<div class="insta-item col-sm-2 col-6 col-md-2">
				<a href="#"><img src="{% static 'images/insta/insta_ash6.png' %}" alt="insta" /></a>
			</div>
		</div>
	</div>
</div>

<script>
// Reply button functionality
document.querySelectorAll('.reply-btn').forEach(function(btn) {
	btn.addEventListener('click', function(e) {
		e.preventDefault();
		var commentId = this.getAttribute('data-comment-id');
		var commentName = this.getAttribute('data-comment-name');
		
		document.getElementById('parent_id').value = commentId;
		document.getElementById('reply-name').textContent = commentName;
		document.getElementById('reply-info').style.display = 'block';
		
		// Scroll to comment form
		document.getElementById('comment-form').scrollIntoView({behavior: 'smooth'});
	});
});

function cancelReply() {
	document.getElementById('parent_id').value = '';
	document.getElementById('reply-info').style.display = 'none';
}
</script>
{% endblock body %}